<!-- /me310/2.32.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Constant-Pressure Surfaces in a Liquid Undergoing Rigid-Body Rotation</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="../styles.css" />
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <!-- MathJax -->
  <script>
    window.MathJax = { chtml:{scale:0.9}, options:{renderActions:{addMenu:[]}} };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    .site-header .container{padding-top:20px;padding-bottom:20px}
    .header-row{display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:1px solid #ffffff55;
         background:rgba(255,255,255,.12);color:#fff;text-decoration:none}
    .btn.primary{background:var(--accent);border-color:transparent}
    .btn.primary:hover{filter:brightness(1.06)}

    .back-row{display:flex;align-items:center;margin:12px 0 14px}
    .back-home{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border:1px solid var(--line);border-radius:999px;
      background:#fff;color:#0ea5e9;text-decoration:none;font-size:14px;
    }
    .back-home:hover{background:#f0f9ff}
    .back-home .chev{font-size:16px;line-height:1}

    /* Layout: derivation + schematic */
    .top-grid{
      display:grid;
      gap:14px;
      margin-top:10px;
    }

    .side-col{display:flex;flex-direction:column;gap:12px}

    @media (min-width:900px){
      .top-grid{
        grid-template-columns:minmax(0,2.1fr) minmax(260px,0.9fr);
        align-items:flex-start;
      }
      .side-col{
        position:sticky;
        top:96px;          /* stay below header */
        align-self:flex-start;
      }
    }

    .eqwrap{margin-bottom:10px}
    .eqwrap p{margin:4px 0}
    .note{font-size:14px;color:#4b5563}

    .schematic-card p{margin:0 0 6px;font-size:14px;color:#4b5563}
    .schematic-img-wrap{display:flex;justify-content:center;align-items:center;margin-top:6px;margin-bottom:4px}
    .schematic-img{display:block;max-width:260px;width:100%;height:auto;object-fit:contain}

    /* Inputs card (full width) */
    .inputs-card{margin-top:18px}
    .inputs-card h2{margin:4px 0 10px}
    .inputs-grid{
      display:grid;
      gap:14px;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    }
    .inputs-grid .ctl{display:flex;flex-direction:column;gap:6px}
    .inputs-grid label{font-size:13px;color:#4b5563}
    .ctl-row{display:flex;gap:8px;align-items:center}
    .ctl-row input[type="range"]{flex:1}
    .ctl-row input[type="number"]{
      width:90px;max-width:100%;padding:6px 8px;
      border:1px solid var(--line);border-radius:8px;
    }

    /* Plots */
    .plots-grid{
      display:grid;gap:14px;margin-top:10px;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    }

    .viz{background:#fff;border:1px solid var(--line);border-radius:12px;padding:8px}
    #plot-omega,#plot-radius,#plot-depth{width:100%;height:auto;display:block}

    .legend-block{margin-top:6px}
    .legend-row{margin-bottom:4px}
    .legend-item{display:inline-flex;align-items:center;gap:6px;margin-right:12px;font-size:13px;color:#334155}
    .legend-item .sw{display:inline-block;width:14px;height:14px;border-radius:3px;border:1px solid #0002}
    .legend-block .dim-note{font-size:13px;color:#6b7280;margin:0;line-height:1.4}

    svg .axis text{font-size:14px}
    svg .axis-title{font-size:16px}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container">
      <div class="header-row">
        <div>
          <h1 style="margin:0">Constant-Pressure Surfaces in a Liquid Undergoing Rigid-Body Rotation</h1>
          <p class="subtitle">Visualize how the free-surface shape depends on angular velocity, tank radius, and liquid depth.</p>
        </div>
        <a class="btn primary feedback-link" href="../feedback.html" target="_blank" rel="noopener">Send feedback</a>
      </div>
    </div>
  </header>

  <main class="container">
    <nav class="back-row">
      <a href="../index.html" class="back-home" aria-label="Back to home">
        <span class="chev">‚Üê</span> Home
      </a>
    </nav>

    <!-- Derivation + schematic -->
    <section class="top-grid">
      <!-- Derivation / equations -->
      <div class="card">
        <h2 style="margin:4px 0 8px">Liquid in Rigid-Body Rotation</h2>

        <div class="eqwrap">
          <p class="note">
            Consider a liquid in a container with circular cross section operating in rigid-body rotation
            with angular velocity \( \omega \) about the vertical \( z \)-axis.
          </p>
          <p class="note">
            <b>Equation for surfaces of constant pressure</b><br>
            (The free surface is a representative constant-pressure surface of the liquid in rigid-body rotation.)
          </p>
          \[
            z = \frac{\omega^2 r^2}{2g} + \text{constant}.
          \]
          <p class="note">
            The constant in the above equation depends on the setup of the \( z \)-coordinate and is also
            a function of geometry and angular velocity. For a given setup of the \( z \)-coordinate, geometry,
            and angular velocity, different values of this constant correspond to different free-surface profiles.
          </p>
        </div>

        <div class="eqwrap">
          <p style="margin:0 0 4px"><b>Constant volume (no spilling)</b></p>
          <p class="note">
            Let the container have radius \( R \) and liquid depth \( H \) when \( \omega = 0 \)
            (so \( H \) is the liquid depth at rest).
            The volume at rest is
          </p>
          \[
            V = \pi R^2 H.
          \]
          <p class="note">
            When rotating at \( \omega \), with the free surface written as
          </p>
          \[
            h = \frac{\omega^2 r^2}{2g} + h_0,
          \]
          <p class="note">
            the volume of liquid is
          </p>
          \[
            \begin{aligned}
              V &= \int_0^R 2\pi r\,h\,dr
                 = \int_0^R 2\pi r\left(\frac{\omega^2 r^2}{2g} + h_0\right)dr \\
                &= 2\pi \left[\frac{\omega^2}{2g}\int_0^R r^3\,dr
                             + h_0\int_0^R r\,dr\right] \\
                &= \frac{\pi \omega^2 R^4}{4g} + \pi R^2 h_0.
            \end{aligned}
          \]
          <p class="note">
            Equating the two expressions for \( V \) gives
          </p>
          \[
            \pi R^2 H
              = \frac{\pi \omega^2 R^4}{4g} + \pi R^2 h_0
              \quad\Rightarrow\quad
              h_0 = H - \frac{\omega^2 R^2}{4g}.
          \]
        </div>

        <div class="eqwrap">
          <p style="margin:0 0 4px"><b>Free-surface equation</b></p>
          <p class="note">
            Substituting \( h_0 \) back into \( h \) gives the free-surface profile
            for a cylindrical container (no spilling):
          </p>
          \[
            z = h
                  = \frac{\omega^2 r^2}{2g}
                    + H - \frac{\omega^2 R^2}{4g}.
          \]
          <p class="note">
            Here \( H \) is the liquid depth when the tank is at rest.
            Different choices of \( \omega \), \( R \), and \( H \) lead to different free-surface profiles.
          </p>
        </div>
      </div>

      <!-- Right column: schematic -->
      <div class="side-col">
        <div class="card schematic-card">
          <h2 style="margin:4px 0 8px">Schematic</h2>
          <p>
            Vertical cylindrical container of radius \( R \) rotating at angular velocity \( \omega \).
            The bottom is at \( z = 0 \); the initial liquid depth at rest is \( H \).
          </p>
          <div class="schematic-img-wrap">
            <img src="../assets/thumbs/2.32.png" alt="Rigid-body rotation schematic" class="schematic-img" />
          </div>
          <p>
            During rotation, the free surface \( z \) becomes parabolic. The depth at the center is
            \( h_0 = H - \dfrac{\omega^2 R^2}{4g} \), and the elevation at the wall is
            \( z(R) = H + \dfrac{\omega^2 R^2}{4g} \).
          </p>
        </div>
      </div>
    </section>

    <!-- Inputs (full width) -->
    <section class="card inputs-card">
      <h2>Inputs</h2>
      <div class="inputs-grid">
        <div class="ctl">
          <label for="omegaSlider">Angular velocity \( \omega \) (rad/s)</label>
          <div class="ctl-row">
            <input id="omegaSlider" type="range" min="0" max="10" step="0.1" value="8">
            <input id="omegaInput" type="number" min="0" max="10" step="0.1" value="8">
          </div>
        </div>
        <div class="ctl">
          <label for="RSlider">Cylinder radius \( R \) (m)</label>
          <div class="ctl-row">
            <input id="RSlider" type="range" min="0.1" max="0.5" step="0.01" value="0.40">
            <input id="RInput" type="number" min="0.1" max="0.5" step="0.01" value="0.40">
          </div>
        </div>
        <div class="ctl">
          <label for="HSlider">Liquid depth at rest (i.e. \( \omega = 0 \)), \( H \) (m)</label>
          <div class="ctl-row">
            <input id="HSlider" type="range" min="0.7" max="1.3" step="0.01" value="1.0">
            <input id="HInput" type="number" min="0.7" max="1.3" step="0.01" value="1.0">
          </div>
        </div>
      </div>
      <p class="note" style="margin-top:10px">
        These values are used to generate three families of free-surface profiles: one varying \( \omega \),
        one varying \( R \), and one varying \( H \).
      </p>
    </section>

    <!-- Intro text for plots -->
    <p class="note" style="margin-top:12px">
      The plots below show the free-surface profiles \( z(r) \) for three different cases:
      varying angular velocity \( \omega \), varying cylinder radius \( R \), and varying liquid depth \( H \).
    </p>

    <!-- Three plots -->
    <section class="plots-grid">
      <!-- Plot 1: vary omega -->
      <div class="card">
        <h3 style="margin:4px 0 6px">Effect of Angular Velocity \( \omega \)</h3>
        <div class="viz">
          <svg id="plot-omega" viewBox="0 0 360 460" aria-label="Free surfaces for different angular velocities"></svg>
        </div>
        <div id="legend-omega" class="legend-block"></div>
      </div>

      <!-- Plot 2: vary R -->
      <div class="card">
        <h3 style="margin:4px 0 6px">Effect of Cylinder Radius \( R \)</h3>
        <div class="viz">
          <svg id="plot-radius" viewBox="0 0 360 460" aria-label="Free surfaces for different radii"></svg>
        </div>
        <div id="legend-radius" class="legend-block"></div>
      </div>

      <!-- Plot 3: vary H -->
      <div class="card">
        <h3 style="margin:4px 0 6px">Effect of Initial Depth \( H \)</h3>
        <div class="viz">
          <svg id="plot-depth" viewBox="0 0 360 460" aria-label="Free surfaces for different depths"></svg>
        </div>
        <div id="legend-depth" class="legend-block"></div>
      </div>
    </section>
  </main>

  <script>
    const g = 9.81;

    function clamp(val, min, max){
      return Math.max(min, Math.min(max, val));
    }

    function makeSurface(omega, R, H, steps){
      const n = steps || 80;
      const h0 = H - (omega*omega*R*R)/(4*g);
      const pts = [];
      for(let i=0;i<=n;i++){
        const r = R * i/n;
        const z = (omega*omega*r*r)/(2*g) + h0;
        pts.push({r,z});
      }
      return {omega,R,H,h0,pts};
    }

    const colors = ['#2563eb','#f97316','#10b981'];

    function buildSurfaces(mode, omega0, R0, H0){
      const surfaces = [];
      if(mode === 'omega'){
        const omegas = [omega0, 0.5*omega0, omega0/3];
        const labels = [
          '\\omega',
          '\\tfrac{1}{2}\\omega',
          '\\tfrac{1}{3}\\omega'
        ];
        omegas.forEach(function(om,i){
          surfaces.push({
            key:'w'+i,
            label:labels[i],
            color:colors[i],
            surface:makeSurface(om,R0,H0)
          });
        });
      }else if(mode === 'radius'){
        const Rs = [R0, 0.5*R0, R0/3];
        const labels = [
          'R',
          '\\tfrac{1}{2}R',
          '\\tfrac{1}{3}R'
        ];
        Rs.forEach(function(R,i){
          surfaces.push({
            key:'r'+i,
            label:labels[i],
            color:colors[i],
            surface:makeSurface(omega0,R,H0)
          });
        });
      }else{ // depth
        const Hs = [H0, 1.2*H0, 1.5*H0];
        const labels = [
          'H',
          '1.2H',
          '1.5H'
        ];
        Hs.forEach(function(H,i){
          surfaces.push({
            key:'h'+i,
            label:labels[i],
            color:colors[i],
            surface:makeSurface(omega0,R0,H)
          });
        });
      }
      return surfaces;
    }

    function initPlot(id, mode){
      const svg = d3.select('#'+id);
      const W = 360, Hh = 460;
      const margin = {top:18,right:16,bottom:54,left:54};
      const iw = W - margin.left - margin.right;
      const ih = Hh - margin.top - margin.bottom;

      svg.attr('viewBox','0 0 '+W+' '+Hh);

      const gMain = svg.append('g').attr('transform','translate('+margin.left+','+margin.top+')');
      const axesG = gMain.append('g').attr('class','axes');
      const curvesG = gMain.append('g').attr('class','curves');

      const xAxisG = axesG.append('g')
        .attr('class','axis axis--x')
        .attr('transform','translate(0,'+ih+')');
      const yAxisG = axesG.append('g')
        .attr('class','axis axis--y');

      axesG.append('text')
        .attr('class','axis-title')
        .attr('x', iw/2)
        .attr('y', ih + 40)
        .attr('text-anchor','middle')
        .text('r (m)');

      axesG.append('text')
        .attr('class','axis-title')
        .attr('transform','translate(-40,'+(ih/2)+') rotate(-90)')
        .attr('text-anchor','middle')
        .text('z (m)');

      const xScale = d3.scaleLinear().range([0,iw]);
      const yScale = d3.scaleLinear().range([ih,0]);

      const line = d3.line()
        .x(function(d){return xScale(d.r);})
        .y(function(d){return yScale(d.z);});

      return {id,mode,svg,gMain,axesG,curvesG,xAxisG,yAxisG,xScale,yScale,line,iw,ih};
    }

    const plots = {
      omega:  initPlot('plot-omega','omega'),
      radius: initPlot('plot-radius','radius'),
      depth:  initPlot('plot-depth','depth')
    };

    function updateLegend(mode, surfaces){
      const lid =
        mode==='omega'  ? 'legend-omega'  :
        mode==='radius' ? 'legend-radius' :
                          'legend-depth';
      const container = document.getElementById(lid);

      let explHTML;
      if(mode === 'omega'){
        explHTML =
          'All curves use the same radius \\(R\\) and depth \\(H\\); only the angular velocity \\(\\omega\\) changes.';
      }else if(mode === 'radius'){
        explHTML =
          'All curves use the same angular velocity \\(\\omega\\) and depth \\(H\\); only the cylinder radius \\(R\\) changes.';
      }else{
        explHTML =
          'All curves use the same angular velocity \\(\\omega\\) and radius \\(R\\); only the initial liquid depth \\(H\\) changes.';
      }

      const itemsHTML = surfaces.map(function(s){
        return '<span class="legend-item"><span class="sw" style="background:'+s.color+'"></span><span>\\('+s.label+'\\)</span></span>';
      }).join('');

      container.innerHTML = '<div class="legend-row">'+itemsHTML+'</div>' +
                            '<p class="dim-note">'+explHTML+'</p>';

      if(window.MathJax && window.MathJax.typesetPromise){
        MathJax.typesetPromise([container]);
      }
    }

    function updatePlot(plot, omega0, R0, H0){
      const surfaces = buildSurfaces(plot.mode, omega0, R0, H0);

      // x domain adapts to the largest radius in this set
      let rMax = 0;
      surfaces.forEach(function(s){
        if(s.surface.R > rMax) rMax = s.surface.R;
      });
      plot.xScale.domain([0, rMax]);

      // fixed y-range so the curves are visually comparable
      plot.yScale.domain([0, 2]);

      const xAxis = d3.axisBottom(plot.xScale).ticks(5);
      const yAxis = d3.axisLeft(plot.yScale).ticks(5);

      plot.xAxisG.call(xAxis);
      plot.yAxisG.call(yAxis);

      const paths = plot.curvesG.selectAll('path.curve')
        .data(surfaces, function(d){return d.key;});

      paths.enter()
        .append('path')
        .attr('class','curve')
        .attr('fill','none')
        .attr('stroke-width',2.2)
        .merge(paths)
        .attr('stroke',function(d){return d.color;})
        .attr('d',function(d){return plot.line(d.surface.pts);});

      paths.exit().remove();

      updateLegend(plot.mode, surfaces);
    }

    function updateAll(){
      const OMIN = 0,   OMAX = 10;
      const RMIN = 0.1, RMAX = 0.5;
      const HMIN = 0.7, HMAX = 1.3;

      let omega = parseFloat(document.getElementById('omegaInput').value);
      let R     = parseFloat(document.getElementById('RInput').value);
      let H     = parseFloat(document.getElementById('HInput').value);

      if(isNaN(omega)) omega = 8;
      if(isNaN(R))     R = 0.40;
      if(isNaN(H))     H = 1.0;

      omega = clamp(omega, OMIN, OMAX);
      R     = clamp(R,     RMIN, RMAX);
      H     = clamp(H,     HMIN, HMAX);

      document.getElementById('omegaInput').value = omega.toFixed(2);
      document.getElementById('RInput').value     = R.toFixed(2);
      document.getElementById('HInput').value     = H.toFixed(2);

      document.getElementById('omegaSlider').value = omega;
      document.getElementById('RSlider').value     = R;
      document.getElementById('HSlider').value     = H;

      updatePlot(plots.omega,  omega, R, H);
      updatePlot(plots.radius, omega, R, H);
      updatePlot(plots.depth,  omega, R, H);
    }

    function bindInputPair(numId, sliderId){
      const num = document.getElementById(numId);
      const sld = document.getElementById(sliderId);
      num.addEventListener('input', updateAll);
      sld.addEventListener('input', function(){
        num.value = sld.value;
        updateAll();
      });
    }

    bindInputPair('omegaInput','omegaSlider');
    bindInputPair('RInput','RSlider');
    bindInputPair('HInput','HSlider');

    window.addEventListener('DOMContentLoaded', function(){
      updateAll();
      if(window.MathJax && MathJax.typesetPromise){
        MathJax.typesetPromise();
      }
    });
  </script>

  <!-- Feedback context -->
  <script>
    const FEEDBACK = { course: 'ME 310', sim: 'Eq 2.32 Constant-Pressure Surfaces in Rigid-Body Rotation' };
    document.addEventListener('DOMContentLoaded', function(){
      const url = new URL('../feedback.html', location.href);
      if (FEEDBACK.course) url.searchParams.set('course', FEEDBACK.course);
      if (FEEDBACK.sim)    url.searchParams.set('sim',    FEEDBACK.sim);
      document.querySelectorAll('a.feedback-link').forEach(function(a){
        a.href = url.toString();
        try { localStorage.setItem('fb_ctx', JSON.stringify(FEEDBACK)); } catch(e){}
      });
    });
  </script>
</body>
</html>
